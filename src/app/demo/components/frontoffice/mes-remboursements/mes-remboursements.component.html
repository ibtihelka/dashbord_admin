<div class="page-container">
  <div class="page-content">

    <div class="remboursements-container">
      <div class="header">
        <div class="title-section">
          <h2 class="title">Mes remboursements</h2>
          <div class="user-info" *ngIf="currentUser"></div>
        </div>

        <!-- Zone debug -->
        <div class="debug-info">
          <div>{{ getDebugInfo() }}</div>
          <div *ngIf="loading" class="loading-text">â³ Chargement en cours...</div>
          <div *ngIf="!loading && !error && remboursements.length > 0" class="found-text">
            âœ… {{ remboursements.length }} remboursement(s) trouvÃ©(s)
          </div>
          <div *ngIf="!loading && !error && remboursements.length === 0" class="empty-text">
            âš ï¸ Aucun remboursement trouvÃ©
          </div>
          <div *ngIf="error" class="error-text">âŒ Erreur</div>
        </div>
      </div>

      <!-- Ã‰tats de chargement / erreur -->
      <div *ngIf="loading" class="loading-container">
        <div class="spinner"></div>
        <p>Chargement des remboursements...</p>
      </div>

      <div *ngIf="error && !loading" class="error-container">
        <div class="error-icon">âš ï¸</div>
        <p class="error-message">{{ error }}</p>
        <button class="retry-button" (click)="loadRemboursements()">RÃ©essayer</button>
      </div>

      <!-- Tableau principal -->
      <div *ngIf="!loading && !error && remboursements.length > 0" class="table-container">
        <div class="table-wrapper">
          <table class="remboursements-table">
            <thead>
              <tr>
                <th>Ref Bordereau</th>
                <th>NÂ° Bulletin de soins</th>
                <th>Date Soin</th>
                <th>BÃ©nÃ©ficiaire</th>
                <th>Montant dÃ©pensÃ©</th>
                <th>Montant remboursÃ©</th>
                <th>Statut</th>
                <th>Observations</th>
                <th>Actions</th>
              </tr>
            </thead>
            <tbody>
              <tr *ngFor="let remb of remboursements; trackBy: trackByRefBs" class="table-row">
                <td>{{ remb.refBorderau || '-' }}</td>
                <td>{{ remb.refBsPhys }}</td>
                <td>{{ formatDate(remb.datBs) }}</td>
                <td>{{ remb.nomPrenPrest || '-' }}</td>
                <td class="amount">{{ formatAmount(remb.mntBs) }}</td>
                <td class="amount">{{ formatAmount(remb.mntBsRemb) }}</td>
                <td>
                  <span class="status-badge" [ngClass]="getStatusClass(remb.statBs)">
                    {{ remb.statBs || 'Non dÃ©fini' }}
                  </span>
                </td>
                <td class="observation">{{ remb.observation || '-' }}</td>
                <td class="actions">
                  <button class="action-icon-button" (click)="onConsulter(remb)" title="Consulter les dÃ©tails">
                    ğŸ‘ï¸
                  </button>
                  <button class="action-icon-button" (click)="onReclamation(remb)" title="Faire une rÃ©clamation">
                    ğŸ“
                  </button>
                  <button class="action-icon-button" title="Vos prestataires de services">
                    ğŸ‘¥
                  </button>
                </td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>

      <!-- Ã‰tat vide -->
      <div *ngIf="!loading && !error && remboursements.length === 0" class="empty-state">
        <div class="empty-icon">ğŸ“­</div>
        <h3>Aucun remboursement trouvÃ©</h3>
        <p>Vous n'avez actuellement aucun remboursement enregistrÃ©.</p>
      </div>
    </div>

  </div>
</div>

<app-client-footer></app-client-footer>
