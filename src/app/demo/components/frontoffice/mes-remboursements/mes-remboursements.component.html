<div class="page-container">
  <div class="page-content">
<div class="header-content">
<button class="btn-back-circle" (click)="goToAccueil()" title="Retour √† l'accueil">
  <i class="pi pi-home"></i>
</button>


</div>



    <div class="remboursements-container">
      <div class="header">
        <div class="title-section">
          <h2 class="title">Mes remboursements</h2>
          <div class="user-info" *ngIf="currentUser"></div>
        </div>

        <!-- Zone debug -->
        <div class="debug-info">
          <div>{{ getDebugInfo() }}</div>
          <div *ngIf="loading" class="loading-text">‚è≥ Chargement en cours...</div>
          <div *ngIf="!loading && !error && remboursements.length > 0" class="found-text">
            ‚úÖ {{ remboursements.length }} remboursement(s) trouv√©(s)
          </div>
          <div *ngIf="!loading && !error && remboursements.length === 0" class="empty-text">
            ‚ö†Ô∏è Aucun remboursement trouv√©
          </div>
          <div *ngIf="error" class="error-text">‚ùå Erreur</div>
        </div>
      </div>

      <!-- √âtats de chargement / erreur -->
      <div *ngIf="loading" class="loading-container">
        <div class="spinner"></div>
        <p>Chargement des remboursements...</p>
      </div>

      <div *ngIf="error && !loading" class="error-container">
        <div class="error-icon">‚ö†Ô∏è</div>
        <p class="error-message">{{ error }}</p>
        <button class="retry-button" (click)="loadRemboursements()">R√©essayer</button>
      </div>

      <!-- Tableau principal -->
      <div *ngIf="!loading && !error && remboursements.length > 0" class="table-container">
        <div class="table-wrapper">
          <table class="remboursements-table">
            <thead>
              <tr>
                <th>Ref Bordereau</th>
                <th>N¬∞ Bulletin de soins</th>
                <th>Date Soin</th>
                <th>B√©n√©ficiaire</th>
                <th>Montant d√©pens√©</th>
                <th>Montant rembours√©</th>
                <th>Statut</th>
                <th>Observations</th>
                <th>Actions</th>
              </tr>
            </thead>
            <tbody>
              <tr *ngFor="let remb of remboursements; trackBy: trackByRefBs" class="table-row">
                <td>{{ remb.refBordereau || '-' }}</td>
                <td>{{ remb.refBsPhys }}</td>
                <td>{{ formatDate(remb.datBs) }}</td>
                <td>{{ remb.nomPrenPrest || '-' }}</td>
                <td class="amount">{{ formatAmount(remb.mntBs) }}</td>
                <td class="amount">{{ formatAmount(remb.mntBsRemb) }}</td>
                <td>
                  <span class="status-badge" [ngClass]="getStatusClass(remb.statBs)">
                    {{ remb.statBs || 'Non d√©fini' }}
                  </span>
                </td>
                <td class="observation">{{ remb.observation || '-' }}</td>
               <td class="actions">
  <!-- D√©tails -->
  <button class="action-icon-button details" (click)="onConsulter(remb)" title="Consulter les d√©tails">
    <i class="pi pi-eye"></i>
  </button>

  <!-- R√©clamation -->
  <button class="action-icon-button reclamation" (click)="onReclamation(remb)" title="Faire une r√©clamation">
<i class="pi pi-pencil"></i>
  </button>

  <!-- Prestataires -->
  <button class="action-icon-button medecins" title="Vos prestataires de services">
    <i class="pi pi-users"></i>
  </button>
</td>


              </tr>
            </tbody>
          </table>
        </div>
      </div>

      <!-- √âtat vide -->
      <div *ngIf="!loading && !error && remboursements.length === 0" class="empty-state">
        <div class="empty-icon">üì≠</div>
        <h3>Aucun remboursement trouv√©</h3>
        <p>Vous n'avez actuellement aucun remboursement enregistr√©.</p>
      </div>
    </div>

  </div>
</div>

<app-client-footer></app-client-footer>
